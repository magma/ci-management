- job-template:
    name: "{project-name}-LF-teravm"
    node: "ci-teravm"
    workspace: /home/magma/logs
    display-name: "LF-TeraVM Integration Test Run"
    build-args: ""
    scm:
      - git:
          url: git@github.com:magma/magma.git
          credentials-id: "jenkins (jenkins-ssh)"
          branches:
            - refs/heads/master
          browser: Auto
    wrappers:
      - lf-infra-wrappers:
          build-timeout: "{build-timeout}"
          jenkins-ssh-credential: "{jenkins-ssh-credential}"
    triggers:
      - github-pull-request:
          trigger-phrase: "^(remerge)$"
          only-trigger-phrase: true
          status-context: "Magma AGW node merge"
          permit-all: true
          github-hooks: true
          white-list-target-branches:
            - "master"
    builders:
      - shell: cd /home/magma;fab restart_teravm_agw:setup_2;fab run_3gpp_tests:setup_2 > /home/magma/logs/log_CI.txt
    publishers:
      - email:
          recipients: "vagrawal@fb.com"
      - email-ext:
          recipients: "vagrawal@fb.com,vaishali.agrawal@techmahindra.com"
          reply-to: "vagrawal@fb.com"
          content-type: default
          subject: "LF Teravm integration"
          body: "Daily 4G test results"
          attach-build-log: false
          compress-log: false
          attachments: "**/*.txt"
          always: true
          send-to:
            - recipients
      - slack:
          team-domain: "magmacore"
          auth-token: "DpdAwCBHaDyOaCl7wKN4DtZ6"
          auth-token-id: "magma-test"
          room: "#magma-test"
          notify-success: True
          notify-aborted: True
          notify-not-built: True
          notify-failure: True
          commit-info-choice: "AUTHORS_AND_TITLES"
          include-custom-message: True
          custom-message: "A teravm integration message."
